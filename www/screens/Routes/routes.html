<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="description" content="" />
    <title>Маршруты</title>
    <link rel="stylesheet" href="../../ui-kit/css/bootstrap.css">
    <link rel="stylesheet" href="../../ui-kit/css/styles.css">
    <link rel="stylesheet" href="style.css">
    <script src="../../ui-kit/js/redirects.js"></script>
    <script src="../../ui-kit/js/deeplinks.js"></script>
</head>

<body>
    <main>
        <div class="screen-hat">
            <button class="btn arrow-back">
                <a href="../Map/map.html">
                    <img src="../../ui-kit/svg/arrow_back.svg" alt="arrow-back">
                </a>
            </button>
            <div class="mb-3">
                <h3 class="text-header">
                    Маршруты
                </h3>
            </div>
        </div>
        <div id="cards-here" class="card-container" style="padding-top: calc(88px + 2em);">
<!--            <div class="trip-card" onclick="start_route(0)">-->
<!--                <a href="#" style="text-decoration:none; display:block; height: 100%; width: 100%;">-->

<!--                    <img src="../../ui-kit/img/icg4y3j7.bmp" alt="place_photo.jpg" class="trip-card__background">-->

<!--                    <div class="trip-card__content">-->
<!--                        <div class="trip-card__rating">-->
<!--                            <div class="trip-card__rating__stars">-->
<!--                                <img src="../../ui-kit/svg/small_star_full.svg" alt="s">-->
<!--                                <img src="../../ui-kit/svg/small_star_full.svg" alt="s">-->
<!--                                <img src="../../ui-kit/svg/small_star_full.svg" alt="s">-->
<!--                                <img src="../../ui-kit/svg/small_star_full.svg" alt="s">-->
<!--                                <img src="../../ui-kit/svg/small_star_full.svg" alt="s">-->
<!--                            </div>-->
<!--                            <div class="trip-card__rating__number">-->
<!--                                4,9-->
<!--                            </div>-->


<!--                        </div>-->

<!--                        <h2 class="trip-card__title" id="1-text">Пешая прогулка в сердце Ярославля</h2>-->
<!--                        <div class="trip-card__footer">-->
<!--                            <div class="trip-card__footer__length"><img src="../../ui-kit/svg/person_walk.svg"-->
<!--                                    alt="person_walk.svg">-->
<!--                                <div id="1-length"></div>-->
<!--                            </div>-->
<!--                            <div class="trip-card__footer__time" id="1-duration">1ч 3мин</div>-->
<!--                            <div class="spacer"></div>-->
<!--                            <button class="trip-card__footer__fake-button"><img src="../../ui-kit/svg/arrow_back.svg"-->
<!--                                    alt="arrow-back.svg but reversed" class="arrow-forward"></button>-->
<!--                        </div>-->

<!--                    </div>-->
<!--                </a>-->

<!--            </div>-->


<!--            <div class="trip-card" onclick="start_route(2)">-->
<!--                <img src="../../ui-kit/img/zsmhme2t.bmp" alt="place_photo.jpg" class="trip-card__background">-->
<!--                <a href="#" style="text-decoration:none; display:block; height: 100%; width: 100%;">-->
<!--                    <div class="trip-card__content">-->
<!--                        <div class="trip-card__rating">-->
<!--                            <div class="trip-card__rating__stars">-->
<!--                                <img src="../../ui-kit/svg/small_star_full.svg" alt="s">-->
<!--                                <img src="../../ui-kit/svg/small_star_full.svg" alt="s">-->
<!--                                <img src="../../ui-kit/svg/small_star_full.svg" alt="s">-->
<!--                                <img src="../../ui-kit/svg/small_star_full.svg" alt="s">-->
<!--                                <img src="../../ui-kit/svg/small_star_half.svg" alt="s">-->
<!--                            </div>-->
<!--                            <div class="trip-card__rating__number">-->
<!--                                4,6-->
<!--                            </div>-->


<!--                        </div>-->

<!--                        <h2 class="trip-card__title" id="3-text">Per aspera ad Astra</h2>-->
<!--                        <div class="trip-card__footer">-->
<!--                            <div class="trip-card__footer__length"><img src="../../ui-kit/svg/person_walk.svg"-->
<!--                                    alt="person_walk.svg">-->
<!--                                <div id="3-length">1,5 km</div>-->
<!--                            </div>-->
<!--                            <div class="trip-card__footer__time" id="3-duration">46мин</div>-->
<!--                            <div class="spacer"></div>-->
<!--                            <button class="trip-card__footer__fake-button"><img src="../../ui-kit/svg/arrow_back.svg"-->
<!--                                    alt="arrow-back.svg but reversed" class="arrow-forward"></button>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </a>-->


<!--            </div>-->

<!--            <div class="trip-card" onclick="start_route(1)">-->
<!--                <img src="../../ui-kit/img/lvsls0y5.bmp" alt="place_photo.jpg" class="trip-card__background">-->
<!--                <a href="#" style="text-decoration:none; display:block; height: 100%; width: 100%;">-->

<!--                    <div class="trip-card__content">-->
<!--                        <div class="trip-card__rating">-->
<!--                            <div class="trip-card__rating__stars">-->
<!--                                <img src="../../ui-kit/svg/small_star_full.svg" alt="s">-->
<!--                                <img src="../../ui-kit/svg/small_star_full.svg" alt="s">-->
<!--                                <img src="../../ui-kit/svg/small_star_full.svg" alt="s">-->
<!--                                <img src="../../ui-kit/svg/small_star_full.svg" alt="s">-->
<!--                                <img src="../../ui-kit/svg/small_star_half.svg" alt="s">-->
<!--                            </div>-->
<!--                            <div class="trip-card__rating__number">-->
<!--                                4,3-->
<!--                            </div>-->


<!--                        </div>-->

<!--                        <h2 class="trip-card__title" id="2-text">Ярославские купола</h2>-->
<!--                        <div class="trip-card__footer">-->
<!--                            <div class="trip-card__footer__length"><img src="../../ui-kit/svg/person_walk.svg"-->
<!--                                    alt="person_walk.svg">-->
<!--                                <div id="2-length">3 km</div>-->
<!--                            </div>-->
<!--                            <div class="trip-card__footer__time" id="2-duration">2ч 14мин</div>-->
<!--                            <div class="spacer"></div>-->
<!--                            <button class="trip-card__footer__fake-button"><img src="../../ui-kit/svg/arrow_back.svg"-->
<!--                                    alt="arrow-back.svg but reversed" class="arrow-forward"></button>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </a>-->
<!--            </div>-->

        </div>
        <footer class="nav-bar">
            <button class="nav-bar__element" onclick="redirect_home()">
                <img src="../../ui-kit/svg/search_icon.svg" alt="search_ico" class="nav-bar__element__icon">
                <div class="nav-bar__element__title">Поиск</div>
            </button>
            <button class="nav-bar__element" onclick="redirect_profile()">
                <img src="../../ui-kit/svg/profile_icon.svg" alt="search_ico" class="nav-bar__element__icon">
                <div class="nav-bar__element__title">Профиль</div>
            </button>
            <button class="nav-bar__element active">
                <img src="../../ui-kit/svg/routes_icon.svg" alt="search_ico" class="nav-bar__element__icon">
                <div class="nav-bar__element__title">Маршруты</div>
            </button>
        </footer>
    </main>
    <script>
        if (localStorage != undefined) {
            localStorage.setItem('prev_page', '/screens/Routes/routes.html');
        }

        // Начать маршрут
        function start_route(route_id) {
            if (localStorage != undefined) {
                localStorage.setItem('route_id', route_id);
                localStorage.setItem('route_place', 0);
                redirect_route_details();
            }
        }

        // Проверка ключа, получение маршрутов
        document.addEventListener('deviceready', () => {
            if (localStorage != undefined) {
                if (localStorage.getItem('auth_key') == null) {
                    document.location.href = '/Login/login.html'
                }
                auth_key = localStorage.getItem('auth_key');
            }
            // api_userdata(auth_key).then((userdata) => {
            //     try {
            //         groutes = JSON.parse(response.data);
            //         groutes.forEach(el => {
            //             document.getElementById(`${el[0]}-text`).innerText = el[1];
            //             document.getElementById(`${el[0]}-length`).innerText = el[4] + 'km';
            //             document.getElementById(`${el[0]}-duration`).innerText = el[3] + 'hr.';
            //         });
            //     } catch (e) {
            //         console.error("JSON parsing error");
            //     }
            // });
            api_groutes(localStorage.getItem('auth_key')).then((groutes) => {
                console.log(groutes);
                document.getElementById('cards-here').innerHTML = "";
                groutes.forEach((el,t) => {
                    api_getrev(el[0],localStorage.getItem('auth_key'),1).then((res)=>{
                        document.getElementById('cards-here').innerHTML += `
                        <div class="trip-card" onclick="start_route(${t})">
                            <a href="#" style="text-decoration:none; display:block; height: 100%; width: 100%;">

                                <img src="https://trip.backend.xredday.ru/${el[2]}" alt="place_photo.jpg" class="trip-card__background">

                                <div class="trip-card__content">
                                    <div class="trip-card__rating">
                                        <div class="trip-card__rating__stars">
                                            ${(res[0] >= 0 ? "<img src=\"../../ui-kit/svg/small_star_full.svg\" alt=\"s\">" : "")}
                                            ${(res[0] >= 1.5 ? "<img src=\"../../ui-kit/svg/small_star_full.svg\" alt=\"s\">" : "")}
                                            ${(res[0] >= 2.5 ? "<img src=\"../../ui-kit/svg/small_star_full.svg\" alt=\"s\">" : "")}
                                            ${(res[0] >= 3.5 ? "<img src=\"../../ui-kit/svg/small_star_full.svg\" alt=\"s\">" : "")}
                                            ${(res[0] >= 4.5 ? "<img src=\"../../ui-kit/svg/small_star_full.svg\" alt=\"s\">" : "")}
                                        </div>
                                        <div class="trip-card__rating__number">
                                            ${res[0]}
                                        </div>


                                    </div>

                                    <h2 class="trip-card__title" id="${t+1}-text">${el[1]}</h2>
                                    <div class="trip-card__footer">
                                        <div class="trip-card__footer__length"><img src="../../ui-kit/svg/person_walk.svg"
                                                alt="person_walk.svg">
                                            <div id="${t+1}-length">${el[4]} км</div>
                                        </div>
                                        <div class="trip-card__footer__time" id="${t+1}-duration">${el[5]} мин.</div>
                                        <div class="spacer"></div>
                                        <button class="trip-card__footer__fake-button"><img src="../../ui-kit/svg/arrow_back.svg"
                                                alt="arrow-back.svg but reversed" class="arrow-forward"></button>
                                    </div>

                                </div>
                            </a>

                        </div>
                        `;
                    });
                    // let tе = localStorage.getItem('route_id');
                    //
                    // if (el[0] == parseInt(t) + 1) {
                    //     let s = el[1];
                    //     let d = el[5];
                    //     let l = "url('../../ui-kit/img/icg4y3j7.bmp')";
                    //     if (tе == '2') {
                    //         l = "url('../../ui-kit/img/zsmhme2t.bmp')";
                    //     } else if (tе == '1') {
                    //         l = "url('../../ui-kit/img/lvsls0y5.bmp')";
                    //     }
                    //     document.getElementById('route-name').innerHTML = s;
                    //     document.getElementById('route-description').innerHTML = d;
                    //     document.getElementById('route-logo').style.backgroundImage = l;
                    //     document.getElementById('route-duration').innerText = el[3] + 'hr.';
                    //     document.getElementById('route-length').innerText = el[4] + 'km';
                    // }
                });
            });
        });
    </script>
    <script src="../../cordova.js"></script>
    <script src="../api.js"></script>
    <script src="../../ui-kit/js/redirects.js"></script>
    <script src="../../ui-kit/js/deeplinks.js"></script>

</body>
</html>